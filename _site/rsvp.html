<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Syd + Tirth - RSVP</title>
    <meta name="description" content="Syd and Tirth get hitched!">

    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <link rel="stylesheet" href="style.css">

    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.6.0/dist/alpine.min.js" defer></script>

    <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script src="./index.js"></script>
</head>

<body x-data="stuff()" @user-login.window="setUser($event.detail)">

    <header class="bg-gray-100 shadow">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <a class="text-3xl font-bold leading-tight text-gray-900" href="/">
                RSVP
            </a>
            <button x-show="userDisplay() === 'Tirth' || userDisplay() === 'Sydney Shapansky'"
                @click="downloadCsv">Download CSV</button>
        </div>
    </header>
    <main>
        <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
            <div x-show="!user" class="container mx-auto px-4">
                <p>Please log in</p>
            </div>

            <div x-show="submitted">
                <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative"
                    role="alert">
                    <strong class="font-bold">Submitted!</strong>
                    <span class="block sm:inline">Thanks for RSVPing.</span>
                </div>
            </div>

            <template x-if="user && !submitted">
                <div class="container mx-auto px-4 space-y-4">

                    <h4 class="text-xl font-semibold leading-tight text-gray-900">
                        Please fill out details for each member of the party:
                    </h4>

                    <form class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                        <div class="mb-4">
                            <label for="guest_name" class="block text-gray-700 text-sm font-bold mb-2">
                                Name
                            </label>
                            <input x-model="currentGuest.name"
                                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                id="guest_name" type="text" placeholder="Name">
                        </div>

                        <div x-show="currentGuest.name">
                            <div class="mb-4">
                                <label for="staying_over" class="block text-gray-700 text-sm font-bold mb-2">
                                    Staying Over?
                                </label>
                                <input x-model="currentGuest.stayingOver"
                                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                    id="staying_over" type="text"
                                    :placeholder="`How long is ${currentGuest.name} staying?`">
                            </div>

                            <div class="mb-4">
                                <label class="block text-gray-700 text-sm font-bold mb-2" for="bubble">
                                    Who's in <span x-text="currentGuest.name"></span>'s social bubble?
                                </label>
                                <input x-model="currentGuest.bubble"
                                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                    id="bubble" type="text"
                                    placeholder="Who are they staying with? Who would they be comfortable seated next to?">
                            </div>

                            <div class="mb-4">
                                <label class="block text-gray-700 text-sm font-bold mb-2" for="dietary">
                                    Dietary Restrictions?
                                </label>
                                <input x-model="currentGuest.dietary"
                                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                    id="dietary" type="text" placeholder="Veg/non-veg, allergies, GF, etc.">
                            </div>

                            <label class="block text-gray-700 text-sm font-bold mb-2" for="wine_select">
                                Wine?
                            </label>
                            <div class="inline-block relative w-64 mb-4">
                                <select id="wine_select" x-model="currentGuest.wine"
                                    class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline">
                                    <option>None</option>
                                    <option>Red</option>
                                    <option>White</option>
                                    <option>Rose</option>
                                </select>
                                <div
                                    class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg"
                                        viewBox="0 0 20 20">
                                        <path
                                            d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
                                    </svg>
                                </div>
                            </div>

                            <div class="mb-4">
                                <label class="block text-gray-700 text-sm font-bold mb-2" for="booze">
                                    Other booze?
                                </label>
                                <input x-model="currentGuest.booze"
                                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                    id="booze" type="text" placeholder="None, beer, wine, gin, tequila, etc.">
                            </div>

                            <div class="mb-4">
                                <label class="block text-gray-700 text-sm font-bold mb-2" for="notes">
                                    Notes?
                                </label>
                                <input x-model="currentGuest.notes"
                                    class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                                    id="notes" type="text" placeholder="We can't wait to see you at our wedding!">
                            </div>

                            <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
                                @click="addGuest()" x-on:click.debounce.750 x-on:click.prevent>
                                Add guest
                            </button>
                        </div>
                    </form>

                    <p x-show="guests.length > 0" class="text-lg italic">Guests</p>

                    <template x-for="guest in guests" :key="guest">

                        <div class="bg-white shadow overflow-hidden sm:rounded-lg">
                            <div class="px-4 py-5 border-b border-gray-200 sm:px-6">
                                <h3 x-text="guest.name" class="text-lg leading-6 font-medium text-gray-900">
                                </h3>
                            </div>
                            <div>
                                <dl>
                                    <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                        <dt class="text-sm leading-5 font-medium text-gray-500">
                                            Staying over
                                        </dt>
                                        <dd x-text="guest.stayingOver"
                                            class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                                        </dd>
                                    </div>
                                    <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                        <dt class="text-sm leading-5 font-medium text-gray-500">
                                            Bubble
                                        </dt>
                                        <dd x-text="guest.bubble"
                                            class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                                        </dd>
                                    </div>
                                    <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                        <dt class="text-sm leading-5 font-medium text-gray-500">
                                            Dietary
                                        </dt>
                                        <dd x-text="guest.dietary"
                                            class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                                        </dd>
                                    </div>
                                    <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                        <dt class="text-sm leading-5 font-medium text-gray-500">
                                            Wine
                                        </dt>
                                        <dd x-text="guest.wine"
                                            class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                                        </dd>
                                    </div>
                                    <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                        <dt class="text-sm leading-5 font-medium text-gray-500">
                                            Booze
                                        </dt>
                                        <dd x-text="guest.booze"
                                            class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                                        </dd>
                                    </div>
                                    <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                        <button class="bg-red-500 hover:bg-red-700 text-white py-2 px-4 rounded"
                                            @click="deleteGuest(guest)">
                                            Delete
                                        </button>
                                    </div>
                                </dl>
                            </div>
                        </div>

                    </template>

                    <button x-show="guests.length > 0"
                        class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded" @click="submit">
                        Submit RSVP for <span x-text="guestSubmitText()"></span>
                    </button>
                </div>
            </template>
        </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.2/FileSaver.min.js"
        integrity="sha512-k8F8QynmFNURwbUJC8drKA+fo3YfNvjqKzStdydD6au+MzvxBoRnxH8E31RJXwDY9DrnEiPhh9wBoDSIxhkyHQ=="
        crossorigin="anonymous"></script>
</body>

</html>